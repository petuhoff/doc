<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="topic_x5n_gv5_qf">
  <title>Пример панели управления </title>
  <body>
    <p>Ниже представлен пример создания простой панели управления в проекте SimInTech,
      обменивающейся данными со Схемным окном. В исходном проекте имеется три одинаковых блока,
      являющихся графическими группами с двумя глобальными свойствами: </p>
    <table id="table_uxf_ljb_ry">
      <tgroup cols="3">
        <colspec colnum="1" colname="col1"/>
        <colspec colnum="2" colname="col2"/>
        <colspec colnum="3" colname="col3"/>
        <tbody>
          <row>
            <entry><b>Название</b></entry>
            <entry><b>Имя</b></entry>
            <entry><b>Значение</b></entry>
          </row>
          <row>
            <entry>Вход 1</entry>
            <entry>input_value</entry>
            <entry>0</entry>
          </row>
          <row>
            <entry>Подпись блока</entry>
            <entry>label</entry>
            <entry>текст</entry>
          </row>
        </tbody>
      </tgroup>
    </table>
    <p><image href="control_panel_sample_images/image001.png" height="683" width="572"
        id="image_vxf_ljb_ry"/></p>
    <p>Глобальные свойства блоков "Group..."</p>
    <p><image href="control_panel_sample_images/image002.png" height="478" width="675"
        id="image_wxf_ljb_ry"/></p>
    <p>Исходный вид Схемного окна</p>
    <p>В данных блоках заложена следующая логика. Если значение input_value блока равно нулю, то
      цвет табло жёлтый, а внутри табло отображается текст «Отключено». Если же значение input_value
      равно 1, то цвет табло зелёный, а внутри табло отображается текст «Включено». Текстовое
      свойство label предназначено для подписи блоков и по умолчанию содержит подпись "текст". Новая
      подпись блока в Схемном окне отобразится при очередном запуске расчета (Схемное окно должно
      находиться в режиме "Индикация").</p>
    <p>Наша задача состоит в том, чтобы создать в данном проекте одну панель управления для всех
      трёх блоков, переключающую значение глобального свойства input_value выбранного блока между
      двумя описанными вариантами: 0 и 1. При этом при вызове панель управления должна содержать
      текст, указанный в подписи вызвавшего её блока и текущее значение свойства input_value этого
      блока.</p>
    <p><image href="control_panel_sample_images/image003.png" height="351" width="158"
        id="image_xxf_ljb_ry"/></p>
    <p>Пример внешнего вида панели управления при вызове из блока «Group1» с подписью «блок №1»</p>
    <p>Сначала подпишем блоки. Для этого нужно выделить один из блоков и по клику ПКМ вызвать
      контекстное меню и выбрать в нем пункт «Свойства объекта». В открывшемся окне свойств во
      вкладке «Общие» нужно найти пункт «Подпись блока» и вместо слова «текст» вписать какую-нибудь
      уникальную подпись, например, «блок №1». Затем нужно повторить эту операцию с двумя
      оставшимися блоками. Для обновления попдисей в схемном окне надо запустить и остановить
      расчёт, предварительно переведя Схемное окно из режима «Редактирование» в режим «Индикация».
      Примерный вид Схемного окна на данном этапе приведен ниже.</p>
    <p><image href="control_panel_sample_images/image004.png" height="361" width="550"
        id="image_yxf_ljb_ry"/></p>
    <p>Вид Схемного окна после изменения подписей блоков "Group..."</p>
    <p>Теперь нужно добавить в наш проект панель управления. Для этого необходимо выполнить
      следующие действия. </p>
    <p>В меню Главного окна SimInTech выбрать пункт <b>«Расчёт →  </b><image
        href="control_panel_sample_images/image005.jpg" id="image_zxf_ljb_ry"/><b>Менеджер
        данных...»</b>. Откроется одноимённое окно.</p> 
    <p><image href="control_panel_sample_images/image006.png" height="169" width="279"
        id="image_ayf_ljb_ry"/></p>
    <p>Окно «Менеджер данных» </p>
    <p>Данное окно также можно вызвать с панели главного окна SimInTech по нажатию на кнопку <image
        href="control_panel_sample_images/image007.png" height="25" width="25" id="image_byf_ljb_ry"
      />. </p>
    <p>Так как в нашем проекте ещё не создано категорий, то сначала нужно создать категорию, нажав
      кнопку <image href="control_panel_sample_images/image008.png" height="30" width="30"
        id="image_cyf_ljb_ry"/> «Добавить категорию» на панели инструментов окна «Менеджер данных».
      Будет создана новая категория. Затем нужно выделить только что созданную категорию и создать
      окно анимации, нажав кнопку <image href="control_panel_sample_images/image009.png" height="29"
        width="29" id="image_dyf_ljb_ry"/> «Окно анимации». </p>
    <p><image href="control_panel_sample_images/image010.png" height="169" width="279"
        id="image_eyf_ljb_ry"/></p>
    <p>Добавление окна анимации в «менеджере данных»</p>
    <p>Созданное окно можно вызвать по двойному клику на его имени в окне «Менеджер данных».
      Одновременно откроется панель графических примитивов SimInTech. </p>
    <p>
      <image href="control_panel_sample_images/image011.png" height="554" width="612"
        id="image_fyf_ljb_ry"/></p>
    <p>Результат вызова панели управления из «менеджера данных» </p>
    <p>Изменим название нашей панели управления на «Переключатель». Для редактирования названия
      можно выделить пункт с названием панели управления в Менеджере данных и нажать клавишу [F2],
      либо выбрать пункт «Переименовать» в конеткстном меню.</p>
    <p>Данная панель управления должна вызываться каждым из трех объектов «Group…». Для организации
      вызова нужно открыть окно свойств одно из наших объектов «Group…» и в строке свойства «Ссылка»
      нажать кнопку <image href="control_panel_sample_images/image012.png" height="30" width="30"
        id="image_gyf_ljb_ry"/>.</p>
    <p><image href="control_panel_sample_images/image013.png" height="683" width="572"
        id="image_hyf_ljb_ry"/></p>
    <p>Свойство «Ссылка» объекта «Group...»</p>
    <p>Откроется окно «Выбор ссылки», в котором нужно выбрать пункт <b>«Панели управления
        </b><b>®</b><b> Переключатель»</b> и нажать кнопку «Ок». Опция «Режим показа формы» должна
      иметь значение «Управление объектом».</p>
    <p><image href="control_panel_sample_images/image014.png" height="378" width="232"
        id="image_iyf_ljb_ry"/></p>
    <p>Выбор объекта, вызываемого по ссылке</p>
    <p>Вернемся к окну свойств объекта «Group…» и установим свойство «Действие для вывода ссылки /
      InstanceMode» в значение «Щелчок правой копкой».</p>
    <p><image href="control_panel_sample_images/image015.png" height="683" width="572"
        id="image_jyf_ljb_ry"/></p>
    <p>Выбор варианта активации ссылки</p>
    <p>Для двух оставшихся объектов нужно повторить изменение свойств «Ссылка» и «Действие для
      вывода ссылки».</p>
    <p>Для проверки работоспособности ссылки переведем Схемное окно из режима «Редактирование» в
      режим «Индикация» по кнопке <image href="control_panel_sample_images/image016.png" height="25"
        width="25" id="image_kyf_ljb_ry"/> / <image href="control_panel_sample_images/image017.png"
        height="25" width="25" id="image_lyf_ljb_ry"/> на панели инструментов Схемного окна и
      запустим расчет проекта по горячей клавише [F9] или по кнопке <image
        href="control_panel_sample_images/image018.png" height="25" width="25" id="image_myf_ljb_ry"
      /> на панели инструментов Главного окна. Если ссылка функционирует правильно, то по клику ПКМ
      на любом из объектов «Group…» должно вызваться окно нашей панели управления. Для продолжения
      работы расчет нужно остановить сочетанием горячих клавиш [Shift]+[F9] или по кнопке <image
        href="control_panel_sample_images/image019.png" height="25" width="25" id="image_nyf_ljb_ry"
      /> на панели инструментов Главного окна. </p>
    <p>Теперь наполним новую панель управления графическими примитивами и зададим для них основные
      свойства. Если панель управления закрыта, для её вызова нужно открыть окно «Менеджер проекта»
      и вызвать нашу панель управления по двойному клику на ее названии.</p>
    <p>Примитив «Текст» для отображения значений глобального свойства input_value выбранного
      блока:</p>
    <ul id="ul_oyf_ljb_ry">
      <li>- Имя «TextLabel»;</li>
      <li>- Текст «input_value = »;</li>
      <li>- Способ показа цифр «Показывать справа».</li>
    </ul>
    <p><image href="control_panel_sample_images/image020.png" height="653" width="450"
        id="image_pyf_ljb_ry"/></p>
    <p>Настройка свойств примитива TextLabel</p>
    <p>Примитив «Текст» для отображения подписи выбранного блока:</p>
    <ul id="ul_qyf_ljb_ry">
      <li>- Имя «TextLabel1».</li>
    </ul>
    <p><image href="control_panel_sample_images/image021.png" height="653" width="450"
        id="image_ryf_ljb_ry"/></p>
    <p>Настройка свойств примитива TextLabel1</p>
    <p>Примитив Кнопка для переключения значений input_value между 0 и 1:</p>
    <ul id="ul_syf_ljb_ry">
      <li>- Имя «Button».</li>
    </ul>
    <p><image href="control_panel_sample_images/image022.png" height="614" width="481"
        id="image_tyf_ljb_ry"/></p>
    <p>Настройка свойств примитива Button</p>
    <p>Примитив «Кнопка» обладает свойством Value, которое отсутствует в перечне свойств, однако оно
      может использоваться в скрипте. Значения этого свойства изменяются при каждом нажатии и
      отжатии кнопки. Значение при отжатой кнопке задается в свойстве «UpValue», а при нажатой – в
      свойстве «DownValue».</p>
    <p>Примитив Линия для визуального оформления панели управления:</p>
    <ul id="ul_uyf_ljb_ry">
      <li>- Имя «Line».</li>
    </ul>
    <p>Результат должен выглядеть аналогично изображению, приведенному в начале данного примера.</p>
    <p>После того, как все объекты добавлены в панель управления, необходимо описать связи между
      свойствами этих объектов и значениями сигналов и свойств объектов на верхнем уровне
      проекта.</p>
    <p>Итак, перед нами стоит задача отображать текущие значения свойств «Вход 1» и «подпись блока»,
      соответствующих блоку, вызвавшему панель управления, а также по нажатию кнопки в панели
      управления изменять значение свойства «Вход 1» (оно же «input_value») между 0 и 1. Первая
      задача решается добавлением в панель управления глобальных свойств, одноименных свойствам
      исходного объекта, и последующим связыванием этих свойств со свойствами текстовых примитивов.
      Тогда при вызове панели управления эти свойства будут автоматически получать значения
      одноименных свойств объекта, вызвавшего панель управления. Чтобы добавить глобальные свойства
      в панель управления нужно вызвать соответствующий редактор из меню окна панели управления:
        <b>«Сервис </b><b>®</b><b> Глобальные свойства…»</b>. Откроется окно редактора.</p>
    <p><image href="control_panel_sample_images/image023.png" height="265" width="641"
        id="image_vyf_ljb_ry"/></p>
    <p>Редактор глобальных свойств</p>
    <p>Добавим свойства «Вход 1» и «Подпись» с параметрами, приведенными на изображении ниже.</p>
    <p><image href="control_panel_sample_images/image024.png" height="265" width="641"
        id="image_wyf_ljb_ry"/></p>
    <p>Параметры добавляемых глобальных свойств панели управления</p>
    <p>Для установления связи между глобальными свойствами панели управления и свойствами
      графических примитивов проще всего воспользоваться редактором связей, который вызывается из
      меню окна панели управления: <b>«Сервис → Связи…»</b>. Откроется окно редактора связей.</p>
    <p><image href="control_panel_sample_images/image025.png" height="429" width="580"
        id="image_xyf_ljb_ry"/></p>
    <p>Редактор связей</p>
    <p>Сначала в левой части окна нужно выбрать вкладку «Общее свойство», в которой отобразится
      список добавленных ранее глобальных свойств. Оба этих свойства нужно перетащить мышью в правую
      часть окна, в колонку «Источник».</p>
    <p><image href="control_panel_sample_images/image026.png" height="429" width="580"
        id="image_yyf_ljb_ry"/></p>
    <p>Выбор глобальных свойств в качестве источников значений</p>
    <p>Затем переключимся на вкладку «Объект» и, поочередно выбирая в окне панели управления
      примитивы TextLabel и TextLabel1, перетащим в колонку «Приемник» из появляющихся списков
      свойств этих примитивов те, которые должны принимать значения указанных глобальных свойств. В
      случае TextLabel нужно установить связь между его свойством Values и глобальным свойством
      input_value, а в случае TextLabel1 между его свойством Text и глобальным свойством label.</p>
    <p><image href="control_panel_sample_images/image027.png" height="429" width="738"
        id="image_zyf_ljb_ry"/></p>
    <p>Добавление свойства TextLabel.Values в качестве приемника значений input_value </p>
    <p><image href="control_panel_sample_images/image028.png" height="429" width="738"
        id="image_azf_ljb_ry"/></p>
    <p>Добавление свойства TextLabel1.Text в качестве приемника значений label </p>
    <p>Вторая задача требует написания скрипта в панели управления, реализующего требуемую логику.
      Для вызова редактора скриптов в панели управления нужно выбрать в меню окна панели управления
      пункт <b>«Сервис → Скрипт…»</b>. Откроется окно редактора скриптов.</p>
    <p><image href="control_panel_sample_images/image029.png" height="520" width="656"
        id="image_bzf_ljb_ry"/></p>
    <p>Редактор скриптов </p>
    <p>Текст скрипта:</p>
    <p><b>initialization</b></p>
    <p>Button.value = input_value;</p>
    <p><b>End;</b></p>
    <p><b>if</b> Button.value = 0 </p>
    <p><b>then</b> Button.down = 0 <i>//</i><i>Кнопка</i><i>отжата</i></p>
    <p><b>else</b> Button.down = 1; <i>//</i><i>Кнопка</i><i>нажата</i></p>
    <p>input_value = Button.value;</p>
    <p>Секция «initialization – end» выполняется один раз при каждом вызове панели управления. Т.е.
      при последовательном вызове панели управления из наших объектов «Group1», «Group2», «Group3»
      она каждый раз будет переинициализироваться даже если пользователь не будет закрывать окно
      панели управления перед новым вызовом. В этой секции происходит считывание текущего значения
      глобального свойства input_value в значение управляющей кнопки Button.value. Несмотря на то,
      что данное свойство отстутствует в списке свойств этого графического примитива, оно может
      использоваться в скрипте. Код, следующий за этой секцией, будет выполняться постоянно, пока
      панель управления открыта из одного объекта. В нём по текущему значению свойства Button.Value
      устанавливается соответствующее изображение кнопки (нажата или отжата), а затем происходит
      передача текущего значения кнопки обратно в глобальное свойство input_value, которое в свою
      очередь изменит значение свойства объекта «Group...», вызвашего панель управления. По
      окончании редактирования скрипта окно редактора следует закрыть нажатием кнопки <image
        href="control_panel_sample_images/image030.png" height="25" width="25" id="image_czf_ljb_ry"
      /> на панели инструментов.</p>
    <p>Теперь можно запустить расчет и проверить работу нашей панели управления.</p>
    <p>Ниже приведена иллюстрация информационных связей, реализованных в данном примере.</p>
    <p><image href="control_panel_sample_images/image031.png" height="337" width="708"
        id="image_dzf_ljb_ry"/></p>
    <p>Схема связей, реализованная в данном примере</p>
  </body>
</topic>
