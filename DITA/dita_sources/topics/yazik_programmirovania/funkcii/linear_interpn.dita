<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="topic_v4b_tyc_rf">
<title>linear_interpn </title>
<shortdesc>Многомерная интерполяция.</shortdesc>
<body>
<section>
      <title>Синтаксис:</title>
      <codeblock>Yp = <funcname>linear_interpn</funcname>(x, val, xp, outmode);</codeblock>
    </section>
<section>
      <title>Аргументы:</title>
      <p>x – сетка аргументов, заданная матрицей [[значения аргументов по размерности 1],...
        [значения аргументов по размерности N]];</p>
      <p>val – массив значений для заданной многомерной сетки. Если N=3 и размерности x[1], x[2] и
        x[3] равны соответственно nx, ny, nz, то номер элемента (начиная с 0) массива val,
        соответствующего координатам (i,j,k) будет равен i+nx(j+ny·k);</p>
      <p>xp – входные интерполируемые координаты. Задаются матрицей, размерностью n на N, где n –
        количество интерполируемых точек, N – размерность интерполяции. Координата i-й точки
        представляется как xp[i][0] …. xp[i][N];</p>
      <p>outmode – метод экстраполяции при выходе за сетку: 0 – линейная экстраполяция, 1- константа
        вне диапазона, 2 – ноль вне диапазона; </p>
    </section>
<section><title>Описание:</title>
<p><codeph>linear_interpn</codeph> – реализует линейную интерполяцию многомерной функции
          <codeph>val</codeph>, зависящей от массива аргументов <codeph>x</codeph> в точках с
        координатами <codeph>xp</codeph>. </p></section>
<section>
      <title>Результат:</title>
      <p>Yp - функция возвращает массив интерполированных значений, размерностью равной количеству
        входных точек n (количеству строк входной матрицы xp). </p>
    </section>  
<section><title>Пример:</title>
<codeblock>x=[[0, 1, 2, 9],  <comment>//Аргументы по размерности i</comment>
  [0, 5, 8],      <comment>//Аргументы по размерности j</comment>
  [0, 3]];        <comment>//Аргументы по размерности k</comment>

<comment>//массив значений функции:</comment>
val=
<comment>//        j = 0                   j = 1                      j = 2</comment>
<comment>//|i=0    1    2    3     |i= 0    1    2     3      |i= 0     1    2     3 |</comment>
[    0,   0.1, 1.1, 1.2,      3.5, 3.3, 6.1,  6.2,       7.1,  7.2, 9.1,  9.2,   <comment>//k=0</comment>
     8.1, 8.3, 5.6, 5.9,      3.7, 3.9, 18.1, 18.3,      15.6, 5.9, 13.7, 13.9]; <comment>//k=1</comment>

xp = [[1, 5, 3],[3, 2, 1]]; <comment>//массив входных точек</comment>
Yp = <funcname>linear_interpn</funcname>(x,val,xp,1);</codeblock></section>
<p>В результате выполнения данного скрипта переменная <codeph>Yp</codeph> получит значение [3.9,
      5.6]. Элементы массива <codeph>Yp</codeph> равны значению функции в точках с координатами [1,
      5, 3] и [3, 2, 1]. Координаты первой точки являются табличными. Определение номера точки в
      трехмерном массиве значений функции происходит по формуле <i>i+nx(j+ny·k)</i>, начиная с 0,
      где <i>i, j, k</i> – номера, под которыми стоят координаты в своих векторах, а <i>nx, ny,
        nz</i> – количество элементов в векторах, образующих <codeph>x</codeph>. В данном случае [i,
      j, k] = [1,1,1] так как 1, 5 и 3 являются элементами с номерами 1 в векторах, образующих
        <codeph>x</codeph>; а [nx, ny, nz] = [4, 3, 2]. Таким образом <i>i+nx(j+ny·k) = 1+4(1+3·1) =
        17</i>, то есть элемент, соответствующий табличным координатам [1,5,3] находится в массиве
      значений функции на 17-ом месте и равняется 3.9. Вручную определить значение, соответствующее
      точке с табличными координатами можно, представив массив условной координатной сеткой в
      соответствии с номерами искомых координат в векторе аргумента соответствующей размерности,
      начиная с 0. В приведенном примере вектор аргументов по размерности <i>k</i> состоит из двух
      элементов, что соответствует группировке массива на две строки. Вектор размерности по <i>j</i>
      состоит из трех элементов, что соответствует разбиению массива на 3 столбца. И вектор
      размерности <i>i</i> состоящий из 4 элементов будет соответствовать разбитию каждого столбца
      на 4 подэлемента. В этом случае координаты 1;5;3, для которых [i, j, k]=[1,1,1], соответствуют
      элементу 3.9, стоящему на пересечении соответствующих координат. Для значений координат не
      являющихся табличными выполняется линейная интерполяция по соседним точкам. </p>  
  </body>
</topic>
